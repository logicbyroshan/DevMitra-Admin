{% extends 'base.html' %}
{% load static %}

{% block title %}All Experience - Admin Panel{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/list-common.css' %}">
<link rel="stylesheet" href="{% static 'css/manage-experience.css' %}">
<link rel="stylesheet" href="{% static 'css/view-all-experience.css' %}">
{% endblock %}

{% block nav_experience %}active{% endblock %}

{% block navbar_left %}
<h1 class="page-title">All Experience</h1>
{% endblock %}

{% block user_info %}{% endblock %}

{% block content %}
<div class="page-actions-header">
    <a href="{% url 'create_experience' %}" class="btn-primary">
        <i class="fas fa-plus-circle"></i> Add New Experience
    </a>
</div>

{% if total_count > 0 %}
<div class="filter-bar section-card">
    <div class="search-wrapper">
        <i class="fas fa-search"></i>
        <input type="text" id="search-input" placeholder="Search by role or company...">
    </div>
    <div class="filter-controls">
        <div class="filter-group">
            <a href="{% url 'list_experience' %}" class="filter-btn {% if not current_filter or current_filter == 'all' %}active{% endif %}">All <span class="count">({{ total_count }})</span></a>
            <a href="{% url 'list_experience' %}?filter=draft" class="filter-btn {% if current_filter == 'draft' %}active{% endif %}">Draft <span class="count">({{ draft_count }})</span></a>
        </div>
        <div class="sort-group">
            <label for="sort-select">Sort by:</label>
            <select id="sort-select">
                <option value="newest">Newest First</option>
                <option value="oldest">Oldest First</option>
                <option value="title-az">Role (A-Z)</option>
                <option value="title-za">Role (Z-A)</option>
            </select>
        </div>
    </div>
</div>
{% endif %}

<div class="experience-grid" id="all-experience-grid">
    {% for experience in experiences %}
    <div class="experience-card {% if experience.is_draft %}draft{% endif %} {% if not experience.is_active %}inactive{% endif %} fade-in" data-status="{% if experience.is_draft %}draft{% else %}active{% endif %}" data-title="{{ experience.position }}" data-date="{{ experience.start_date|date:'Y-m-d' }}" data-experience-id="{{ experience.id }}">
        <div class="experience-header">
            <div class="company-logo">
                {% if experience.company_logo %}
                    <img src="{{ experience.company_logo.url }}" alt="{{ experience.company_name }}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px;">
                {% else %}
                    <i class="fas fa-building"></i>
                {% endif %}
            </div>
            <div class="experience-info">
                <h4 class="role-title">{{ experience.position }}</h4>
                <p class="company-name">{{ experience.company_name }}</p>
            </div>
        </div>
        <div class="experience-body">
            <div class="experience-meta">
                <span class="duration"><i class="fas fa-calendar-alt"></i> {{ experience.duration }}</span>
                <span class="employment-type"><i class="fas fa-briefcase"></i> {{ experience.get_employment_type_display }}</span>
            </div>
            <p class="experience-description">{{ experience.short_description|truncatewords:25 }}</p>
            <div class="experience-footer">
                <div class="skills-tags">
                    {% if experience.location %}
                    <span class="skill-tag"><i class="fas fa-map-marker-alt"></i> {{ experience.location }}</span>
                    {% endif %}
                </div>
                <div class="status-badges">
                    {% if experience.is_draft %}
                    <span class="status-badge status-draft">Draft</span>
                    {% elif experience.employment_status == 'current' %}
                    <span class="status-badge status-active">Current</span>
                    {% else %}
                    <span class="status-badge status-inactive">Past</span>
                    {% endif %}
                    {% if not experience.is_active %}
                    <span class="status-badge status-inactive">Inactive</span>
                    {% endif %}
                </div>
            </div>
        </div>
        <div class="card-actions">
            <div class="action-buttons">
                <a href="{% url 'edit_experience' experience.id %}" class="btn-icon btn-edit" title="Edit Experience">
                    <i class="fas fa-pencil-alt"></i> Edit
                </a>
                <button class="btn-icon btn-delete" data-experience-id="{{ experience.id }}" data-experience-title="{{ experience.position }}" title="Delete Experience">
                    <i class="fas fa-trash-alt"></i> Delete
                </button>
            </div>
            <label class="toggle-switch">
                <input type="checkbox" class="experience-toggle" data-experience-id="{{ experience.id }}" {% if experience.is_active %}checked{% endif %}>
                <span class="slider"></span>
            </label>
        </div>
    </div>
    {% empty %}
    <div class="empty-state">
        <i class="fas fa-briefcase"></i>
        <p>No experience found. Add your first experience!</p>
    </div>
    {% endfor %}
</div>

<div class="no-results" id="no-results" style="display: none;">
    <i class="fas fa-search"></i>
    <p>No experience found matching your criteria.</p>
</div>
<div class="no-results" id="no-results" style="display: none;">
    <i class="fas fa-search"></i>
    <p>No experience found matching your criteria.</p>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/view-all-experience.js' %}"></script>
{% endblock %}